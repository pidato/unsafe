package heap

type Freelist struct {
}

var (
	smallClasses = [...]Class{
		{0, 31, 12}, {1, 30, 16}, {2, 29, 20},
		{3, 28, 24}, {4, 27, 28}, {5, 26, 36},
		{6, 25, 44}, {7, 24, 60}, {8, 23, 76},
		{9, 22, 92}, {10, 21, 124}, {11, 20, 156},
		{12, 19, 188}, {13, 18, 220}, {14, 17, 252},
		{15, 16, 300}, {16, 15, 364}, {17, 14, 428},
		{18, 13, 508}, {19, 12, 764}, {20, 11, 1020},
		{21, 10, 1280}, {22, 9, 1532}, {23, 8, 2044},
		{24, 7, 4092}, {25, 6, 8188}, {26, 5, 16380},
	}
	smallClassesSmall = [...]Class{
		{0, 31, 12}, {0, 31, 12}, {0, 31, 12},
		{0, 31, 12}, {1, 30, 16}, {2, 29, 20},
		{3, 28, 24}, {4, 27, 28}, {5, 26, 36},
		{5, 26, 36}, {6, 25, 44}, {6, 25, 44},
		{7, 24, 60}, {7, 24, 60}, {7, 24, 60},
		{7, 24, 60}, {8, 23, 76}, {8, 23, 76},
		{8, 23, 76}, {8, 23, 76}, {9, 22, 92},
		{9, 22, 92}, {9, 22, 92}, {9, 22, 92},
		{10, 21, 124}, {10, 21, 124}, {10, 21, 124},
		{10, 21, 124}, {10, 21, 124}, {10, 21, 124},
		{10, 21, 124}, {10, 21, 124}, {11, 20, 156},
		{11, 20, 156}, {11, 20, 156}, {11, 20, 156},
		{11, 20, 156}, {11, 20, 156}, {11, 20, 156},
		{11, 20, 156}, {12, 19, 188}, {12, 19, 188},
		{12, 19, 188}, {12, 19, 188}, {12, 19, 188},
		{12, 19, 188}, {12, 19, 188}, {12, 19, 188},
		{13, 18, 220}, {13, 18, 220}, {13, 18, 220},
		{13, 18, 220}, {13, 18, 220}, {13, 18, 220},
		{13, 18, 220}, {13, 18, 220}, {14, 17, 252},
		{14, 17, 252}, {14, 17, 252}, {14, 17, 252},
		{14, 17, 252}, {14, 17, 252}, {14, 17, 252},
		{14, 17, 252}, {15, 16, 300}, {15, 16, 300},
		{15, 16, 300}, {15, 16, 300}, {15, 16, 300},
		{15, 16, 300}, {15, 16, 300}, {15, 16, 300},
		{15, 16, 300}, {15, 16, 300}, {15, 16, 300},
		{15, 16, 300}, {16, 15, 364}, {16, 15, 364},
		{16, 15, 364}, {16, 15, 364}, {16, 15, 364},
		{16, 15, 364}, {16, 15, 364}, {16, 15, 364},
		{16, 15, 364}, {16, 15, 364}, {16, 15, 364},
		{16, 15, 364}, {16, 15, 364}, {16, 15, 364},
		{16, 15, 364}, {16, 15, 364}, {17, 14, 428},
		{17, 14, 428}, {17, 14, 428}, {17, 14, 428},
		{17, 14, 428}, {17, 14, 428}, {17, 14, 428},
		{17, 14, 428}, {17, 14, 428}, {17, 14, 428},
		{17, 14, 428}, {17, 14, 428}, {17, 14, 428},
		{17, 14, 428}, {17, 14, 428}, {17, 14, 428},
		{18, 13, 508}, {18, 13, 508}, {18, 13, 508},
		{18, 13, 508}, {18, 13, 508}, {18, 13, 508},
		{18, 13, 508}, {18, 13, 508}, {18, 13, 508},
		{18, 13, 508}, {18, 13, 508}, {18, 13, 508},
		{18, 13, 508}, {18, 13, 508}, {18, 13, 508},
		{18, 13, 508}, {18, 13, 508}, {18, 13, 508},
		{18, 13, 508},
	}
	smallClassesMedium = [...]Class{
		{18, 13, 508}, {19, 12, 764}, {20, 11, 1020},
		{21, 10, 1280}, {22, 9, 1532}, {23, 8, 2044},
		{23, 8, 2044}, {24, 7, 4092}, {24, 7, 4092},
		{24, 7, 4092}, {24, 7, 4092}, {24, 7, 4092},
		{24, 7, 4092}, {24, 7, 4092}, {24, 7, 4092},
		{25, 6, 8188}, {25, 6, 8188}, {25, 6, 8188},
		{25, 6, 8188}, {25, 6, 8188}, {25, 6, 8188},
		{25, 6, 8188}, {25, 6, 8188}, {25, 6, 8188},
		{25, 6, 8188}, {25, 6, 8188}, {25, 6, 8188},
		{25, 6, 8188}, {25, 6, 8188}, {25, 6, 8188},
		{25, 6, 8188}, {26, 5, 16380}, {26, 5, 16380},
		{26, 5, 16380}, {26, 5, 16380}, {26, 5, 16380},
		{26, 5, 16380}, {26, 5, 16380}, {26, 5, 16380},
		{26, 5, 16380}, {26, 5, 16380}, {26, 5, 16380},
		{26, 5, 16380}, {26, 5, 16380}, {26, 5, 16380},
		{26, 5, 16380}, {26, 5, 16380}, {26, 5, 16380},
		{26, 5, 16380}, {26, 5, 16380}, {26, 5, 16380},
		{26, 5, 16380}, {26, 5, 16380}, {26, 5, 16380},
		{26, 5, 16380}, {26, 5, 16380}, {26, 5, 16380},
		{26, 5, 16380}, {26, 5, 16380}, {26, 5, 16380},
		{26, 5, 16380}, {26, 5, 16380},
	}
)

func SmallAllocSize(size uintptr) Class {
	if size < 509 {
		index := divRoundUp(size, 4)
		return smallClasses[index]
	}
	if size < 16381 {
		index := divRoundUp(size-508, 256)
		return smallClassesMedium[index]
	}
	return Class{0, 0, 0}
}

type FreelistSmall16 struct {
	fl      uint32
	classes [30]uint16
}

func (fls *FreelistSmall16) AllocSize(size uintptr) Class {
	return SmallAllocSize(size)
}

type Freelist64 struct {
}
